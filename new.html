<style>
iframe 
{
	border: 0px;
	width: 100%;
	height: 100%;
}
html, body {
  border: 0px;
  margin: 0px;
  padding: 0px;
}
table
{
	width: 100%;
	text-align: center;
}
.rtd
{
	text-align: right;
}
.ltd
{
	text-align: left;
}
.midtd
{
	width: 300px;
	text-align: center;
}
#floater
{
position: absolute;
text-align: center;
width: 100%;
display: none;
}
</style>
<script>
var all_data = [];
var cur_value = 0;
var proxyOn = false;

function loadEntry(value)
{

	if (cur_value < 0) cur_value = 0;
	if (cur_value >= all_data.length) cur_value = all_data.length-1;
	var company = "";
	var ad1 = all_data[value][2]
	var ad2 = "";
	var city = "";
	var state = "";
	var zip = all_data[value][3]

	document.getElementById("company").innerHTML = all_data[value][0]+" "+all_data[value][1];
	var url;
	if (proxyOn)
		url = "http://home.rickyayoub.com/proxy?url=https://tools.usps.com/go/ZipLookupResultsAction!input.action?resultMode=1&companyName="+company+"&address1="+ad1+"&address2="+ad2+"&city="+city+"&state="+state+"&urbanCode=&postalCode=&zip="+zip
	else
		url = "https://tools.usps.com/go/ZipLookupResultsAction!input.action?resultMode=1&companyName="+company+"&address1="+ad1+"&address2="+ad2+"&city="+city+"&state="+state+"&urbanCode=&postalCode=&zip="+zip
	document.getElementById("usps_frame").src = url;
}

function loadCurEntry()
{
document.getElementById("usps_frame").src = document.getElementById("usps_frame").src;
}

function loadPrevEntry()
{
cur_value--;
loadEntry(cur_value);
}

function loadNextEntry()
{
cur_value++;
loadEntry(cur_value);
}

function submit_info()
{
	var data =  document.getElementById('usps_frame').contentWindow.document.getElementById("addresses").value;

	// go through lines
	var lines = data.split("\n");
	for (var x=0; x<lines.length; x++)
	{
		var pieces = lines[x].split("\t");

		if (pieces.length == 4)
		{
			if (pieces[3].length < 5)
				pieces[3] = "00000".substring(pieces[3].length)+pieces[3];

			if (pieces[3].length > 5)
			{
				if (pieces[3].length > 6 && pieces[3].substring(6, pieces[3].length-1) != "0000")
				{
					continue;
				}
				pieces[3] = pieces[3].substring(0, 5);
			}
			console.log(pieces[3]);
		}	
		
		all_data.push(pieces);
	}
	loadEntry(0);
	document.getElementById("floater").style.display = "block";
}

function proxySwap()
{
	if (proxyOn)
		document.getElementById("proxybutton").innerHTML = "Use Proxy";
	else
		document.getElementById("proxybutton").innerHTML = "Use USPS";

	proxyOn = !proxyOn;

	loadEntry(cur_value);	

}
</script>
<title>USPS Zip4 Codes</title>
<div id="floater">
<table><tr><td class="rtd">
<button onclick="loadCurEntry()">Refresh</button><button onclick="loadPrevEntry()">Prev</button></td><td class="midtd">
<span id="company">Company Name</span></td><td class="ltd">
<button id="proxybutton" onclick="proxySwap();">Use Proxy</button><button onclick="loadNextEntry();">Next</button></td></tr></table>
</div>

<iframe id="usps_frame" src="lookup.html" name="usps_frame"></iframe>
